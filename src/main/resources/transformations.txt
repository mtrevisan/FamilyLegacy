direct:
for-each SOUR xref create SOURCE
	SOURCE.xref = SOUR.xref
	SOURCE.LOCATION.value = SOUR.PAGE.value
	SOURCE.ROLE.value = SOUR.EVEN.ROLE.value
	load SOURCE[rec] from SOUR.xref
	SOURCE[rec].EVENT = SOUR.EVEN.value
	SOURCE[rec].DATE = SOUR.DATA.DATE
	for-each SOUR.OBJE xref
		load OBJE[rec] from SOUR.OBJE.xref
		for-each OBJE[rec].FILE
			pick-each: SOURCE.FILE.value = OBJE[rec].FILE.value
			pick-each: SOURCE.FILE.DESCRIPTION.value = OBJE[rec].TITL.value
			pick-one: SOURCE.MEDIA_TYPE.value = OBJE[rec].FORM.TYPE.value
		transfer OBJE[rec].NOTE to SOURCE.NOTE
	for-each SOUR.OBJE
		pick-each: SOURCE.FILE.value = SOUR.OBJE.FILE.value
		pick-each: SOURCE.FILE.DESCRIPTION.value = SOUR.OBJE.TITL.value
		pick-each: SOURCE[ref].CUTOUT = SOUR.OBJE._CUTD.value
		pick-one: SOURCE.MEDIA_TYPE.value = SOUR.OBJE.FORM.MEDI.value
		remember which one has the _PREF tag
   for-each SOUR.DATA.TEXT
		pick-each: SOURCE.FILE.EXTRACT.value = SOUR.DATA.TEXT.value
	transfer SOUR.NOTE to SOURCE.NOTE
	SOURCE[ref].CREDIBILITY.value = SOUR.QUAY.value
for-each SOUR value create SOURCE, SOURCE[ref]
	SOURCE.TITLE = SOUR.value
	transfer SOUR.NOTE to SOURCE[ref].NOTE
	for-each SOUR.OBJE xref
		load OBJE[rec] from SOUR.OBJE.xref
		for-each OBJE[rec].FILE
			pick-each: SOURCE.FILE.value = OBJE[rec].FILE.value
			pick-each: SOURCE.FILE.DESCRIPTION.value = OBJE[rec].TITL.value
			pick-one: SOURCE.MEDIA_TYPE.value = OBJE[rec].FORM.TYPE.value
		transfer OBJE[rec].NOTE to SOURCE.NOTE
	for-each SOUR.OBJE
		pick-each: SOURCE.FILE.value = SOUR.OBJE.FILE.value
		pick-each: SOURCE.FILE.DESCRIPTION.value = SOUR.OBJE.TITL.value
		pick-each: SOURCE[ref].CUTOUT = SOUR.OBJE._CUTD.value
		pick-one: SOURCE.MEDIA_TYPE.value = SOUR.OBJE.FORM.MEDI.value
		remember which one has the _PREF tag
	for-each SOUR.TEXT
		pick-each: SOURCE.FILE.EXTRACT.value = SOUR.DATA.TEXT.value
	transfer SOUR.NOTE to SOURCE.NOTE
	SOURCE[ref].CREDIBILITY = SOUR.QUAY


reverse:
for-each SOURCE xref create SOUR
	SOUR.xref = SOUR.xref
	SOUR.PAGE.value = SOURCE.LOCATION.value
	SOUR.EVEN.ROLE.value = SOURCE.ROLE.value
	SOUR.DATA.DATE.value = SOURCE[rec].DATE.value
	SOUR.DATA.TEXT.value = SOURCE.FILE.EXTRACT.value
	for-each SOURCE.FILE
		pick-each: SOUR.OBJE.FILE.value = SOURCE.FILE.value
		pick-each: SOUR.OBJE.TITL.value = SOURCE.FILE.DESCRIPTION.value
		pick-each: SOUR.OBJE._CUTD.value = SOURCE[ref].CUTOUT
		pick-one: SOUR.OBJE.FORM.MEDI.value = SOURCE.MEDIA_TYPE.value
		remember which one has the _PREF tag
	transfer SOURCE.NOTE to SOUR.NOTE
	SOUR.QUAY.value = SOURCE.CREDIBILITY.value
